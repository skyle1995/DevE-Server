# Setting 模块

## 简介

`Setting` 模块负责管理应用程序的全局配置和设置项，提供了创建、读取、更新和删除系统设置的功能。该模块支持按分组管理设置，方便系统管理员配置和维护系统参数，确保系统运行的灵活性和可配置性。

## 功能特点

- 设置管理：创建、读取、更新和删除系统设置
- 分组管理：支持按分组组织和查询设置
- 权限控制：普通会员和VIP会员只能查看设置，管理员可以管理设置
- 批量操作：支持批量更新设置
- 类型转换：自动处理不同类型的设置值

## 模块结构

```
setting/
├── controller.go          # 控制器，处理HTTP请求
├── model/                 # 数据模型
│   ├── request.go         # 请求模型
│   └── response.go        # 响应模型
├── router.go              # 路由配置
├── service.go             # 业务逻辑服务
└── README.md              # 模块说明文档
```

## API 接口

### 获取系统设置列表

- **URL**: `/api/settings`
- **方法**: GET
- **认证**: 需要用户登录
- **描述**: 获取系统设置列表，可按分组筛选
- **请求参数**:
  - `group`: 设置分组，可选

- **响应示例**:

```json
{
  "code": 200,
  "data": [
    {
      "group": "app",
      "settings": [
        {
          "id": 1,
          "key": "max_app_count",
          "value": "5",
          "description": "用户最大应用数量",
          "group": "app",
          "created_at": "2023-01-01T12:00:00Z",
          "updated_at": "2023-01-01T12:00:00Z"
        },
        {
          "id": 2,
          "key": "app_trial_days",
          "value": "7",
          "description": "应用试用天数",
          "group": "app",
          "created_at": "2023-01-01T12:00:00Z",
          "updated_at": "2023-01-01T12:00:00Z"
        }
      ]
    }
  ],
  "message": "获取成功"
}
```

### 创建系统设置

- **URL**: `/api/admin/settings`
- **方法**: POST
- **认证**: 需要管理员权限
- **描述**: 创建新的系统设置
- **请求示例**:

```json
{
  "key": "site_name",
  "value": "DevE System",
  "group": "site",
  "description": "网站名称"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "data": {
    "id": 3,
    "key": "site_name",
    "value": "DevE System",
    "description": "网站名称",
    "group": "site",
    "created_at": "2023-01-02T12:00:00Z",
    "updated_at": "2023-01-02T12:00:00Z"
  },
  "message": "创建成功"
}
```

### 更新系统设置

- **URL**: `/api/admin/settings`
- **方法**: PUT
- **认证**: 需要管理员权限
- **描述**: 更新已有的系统设置
- **请求示例**:

```json
{
  "key": "site_name",
  "value": "DevE System Pro",
  "description": "网站名称（专业版）"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "data": {
    "id": 3,
    "key": "site_name",
    "value": "DevE System Pro",
    "description": "网站名称（专业版）",
    "group": "site",
    "created_at": "2023-01-02T12:00:00Z",
    "updated_at": "2023-01-03T10:00:00Z"
  },
  "message": "更新成功"
}
```

## 使用说明

1. 用户可以通过获取系统设置接口查看系统配置
2. 管理员可以通过创建、更新和删除接口管理系统设置
3. 设置可以按分组进行组织和查询，方便管理
4. 设置值统一存储为字符串，使用时需要进行类型转换
5. 敏感设置（如密钥、密码等）应该加密存储

## 设置分组说明

系统设置通常按以下分组进行组织：

- **system**: 系统基本设置（如网站名称、描述等）
- **app**: 应用相关设置（如最大应用数量、试用天数等）
- **user**: 用户相关设置（如注册开关、默认角色等）
- **mail**: 邮件相关设置（如SMTP服务器、发件人等）
- **payment**: 支付相关设置（如支付接口配置等）

## 开发与扩展

如需扩展系统设置模块功能，可以考虑以下方向：

1. 添加设置缓存机制，提高频繁访问设置的性能
2. 实现设置历史记录功能，跟踪设置的变更历史
3. 添加设置导入/导出功能，方便系统配置的备份和迁移
4. 实现设置模板功能，预定义常用的设置组合
5. 添加设置验证功能，确保设置值符合预期格式和范围